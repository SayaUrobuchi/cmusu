---
layout: post
title: "[paiza] S003:嘘つき探し"
date: '2014-12-05T22:34:00.000+08:00'
author: 沙耶
tags:
- paiza
modified_time: '2014-12-09T21:39:15.759+08:00'
blogger_id: tag:blogger.com,1999:blog-8266072452384584139.post-1429064261353945280
blogger_orig_url: http://cmusu.blogspot.com/2014/12/paiza-s003.html
---

<a href="https://paiza.jp/challenges/info" target="_blank">https://paiza.jp/challenges/info</a><br /><br />翻譯：<br /><br />有個由老實人和騙子組成的村莊，共N個人，老實人只說真話，騙子只說謊話。<br />身為偵探的你，為了查明誰是老實人、誰是騙子，開始訪查村人。當時的訪查記錄以以下兩種形式留存：<br /><br /><ul style="background-color: white; font-family: Verdana, Arial, sans-serif; font-size: 15px; line-height: 27.7199993133545px; list-style-image: initial; list-style-position: initial; margin: 0px 0px 0px 20px; padding: 0px;"><li style="margin: 0px; padding: 0px;">1 said 2 was an honest person.</li><li style="margin: 0px; padding: 0px;">3 said 1 was a liar.</li></ul><div><span style="font-family: Verdana, Arial, sans-serif;"><span style="font-size: 15px; line-height: 27.7199993133545px;"><br /></span></span></div><div>分別表示村人1說村人2是老實人，村人3說村人1是騙子。</div><div><br /></div><div>你本來以為這樣就能確認誰老實、誰說謊，結果發現符合的情況並不唯一。</div><div>因此，身為偵探同時又有優異的編程技巧的你，決定先寫個程式數數看有多少種可能。</div><div>但是你發現可能性太多了，所以決定只計算大概有幾位數就好。</div><div><br /></div><div>輸入M行的訪查記錄，若可能情形為S種，就輸出S的二進制表示下共有幾位數。</div><div>若矛盾無解，則輸出-1。</div><div><br /></div><div><br /></div><div><br /><a name='more'></a>========</div><div><br /></div><div>從題意很簡單可以畫出一個單向圖。</div><div><br /></div><div>觀察後會發現，其實如果兩個點之間完全沒路可通，那這兩點互不影響，這也很直覺。</div><div><br /></div><div>再觀察會發現，隨便抓兩個點A和B出來，且A有一條邊連到B，則有兩種情形：</div><div><br /></div><div><ul><li>A說B是騙子</li><li>A說B是老實人</li></ul><div>如果我們隨便假定A看看，會發現：</div></div><div><ul><li>假如A是騙子，A說B是騙子，則B是老實人</li><li>假如A是騙子，A說B是老實人，則B是騙子</li><li>假如A是老實人，A說B是騙子，則B是騙子</li><li>假如A是老實人，A說B是老實人，則B是老實人</li></ul><div>於是我們發現：決定A時，B就跟著決定了。</div></div><div><br /></div><div>再觀察B，會發現：</div><div><ul><li>假如B是騙子，A說B是騙子，則A是老實人</li><li>假如B是騙子，A說B是老實人，則A是騙子</li><li>假如B是老實人，A說B是騙子，則A是騙子</li><li>假如B是老實人，A說B是老實人，則A是老實人</li></ul><div>有注意到什麼嗎？決定B後，A也跟著決定了。而且不是B說A，而是A說B的，結果卻一樣。<br />由此判斷，說人和被說的立場根本無關。所以實際上這圖可以當無向圖看待。<br /><br />總結一下結論：<br /><br /><ul><li>圖是無向圖，邊是無向邊。</li><li>不連通的塊獨立看待。</li></ul><div>接下來我們看同一個連通塊的情形，最後所有連通塊的可能性相乘就是答案了。</div><div><br /></div><div>假如我們隨便抓一個人，聲稱他是騙子。</div><div>於是所有與他相連的人，是老實人還是騙子，就全都被決定了。</div><div>同理這些相連的人又會決定所有相連的人，最後整個連通塊都被決定了。</div><div>我們只要看中間有沒有矛盾就可以了。</div><div><br /></div><div>又，根據上面的觀察，我們發現，在邊不變的情況下，把一個點反轉，周圍的點會全部反轉。</div><div>所以只要聲稱一人是騙子，不會造成矛盾，那聲稱他是老實人，也不會有矛盾。</div><div>只要所有點一起反轉就會符合。</div><div><br /></div><div>因此我們得到一個結論：</div><div>每個連通塊要嘛矛盾，要嘛有2種可能：其中一人是騙子、或者是老實人。其他人會因為他被決定身份。</div><div><br /></div><div>檢查矛盾時只要一開始把所有點設為0，然後枚舉所有點，如果它值是0，代表它是新連通塊。</div><div>對它做DFS/BFS，將他設成1或-1隨便，走訪一下看有沒矛盾，其中一種沒矛盾、另一種就不會。</div><div>走過的點記得標起來，枚舉時跳過它。</div><div><br /></div><div>可以把「A說B是老實人」想成A到B的邊權重是1，「A說B是騙子」想成權重-1。</div><div>對於任意點A所有相鄰點B，需滿足B = A * 邊權(A, B)。</div><div><br /></div><div>若沒矛盾，答案就會是連通塊數+1。因為每多一個連通塊，可能情況就變成兩倍。</div><div>二進制下就是多一位數。</div><div><br /></div><div>於是得到一個O(n+m)的算法。幾乎就是圖遍歷就做完了。</div><div><br /></div><div>最後，注意n=1、m=0的情況、注意自連邊和重邊。</div></div></div>